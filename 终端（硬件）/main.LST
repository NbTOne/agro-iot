C51 COMPILER V9.59.0.0   MAIN                                                              12/13/2018 14:59:01 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: D:\Software\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          /*******************************************************************************
   2          *                 
   3          *                            ÆÕÖÐ¿Æ¼¼
   4          --------------------------------------------------------------------------------
   5          * Êµ Ñé Ãû     : 18B20ÎÂ¶ÈÏÔÊ¾ÊÔÑé
   6          * ÊµÑéËµÃ÷       : LCD1602ÏÔÊ¾ÎÂ¶ÈÖµ£¬²¢ÇÒ½«ÎÂ¶ÈÖµÍ¨¹ý´®¿Ú·¢ËÍµ½µçÄÔÉÏ¡£
   7          * Á¬½Ó·½Ê½       : ¼ûÁ¬½ÓÍ¼
   8          * ×¢    Òâ     : 
   9          *******************************************************************************/
  10          
  11          #include<reg51.h>
  12          #include"lcd.h"
  13          #include"temp.h"
  14          
  15          uchar CNCHAR[6] = "ÉãÊÏ¶È";
  16          void LcdDisplay(int);
  17          void UsartConfiguration();
  18          
  19          
  20          /**
  21           * UART·¢ËÍÒ»×Ö½Ú
  22          */
  23          void UART_Send_Byte(unsigned char dat)
  24          {
  25   1        SBUF = dat;
  26   1        while (TI == 0);
  27   1        TI = 0;
  28   1      }
  29          
  30          /**
  31           * ½«Êý¾Ý×ª»»³ÉASCÂë²¢Í¨¹ýUART·¢ËÍ³öÈ¥
  32          */
  33          void UART_Send_Dat(unsigned char dat)
  34          {
  35   1        UART_Send_Byte(dat/10%10 + '0');
  36   1        UART_Send_Byte(dat%10 + '0');
  37   1      }
  38          
  39          /*******************************************************************************
  40          * º¯ÊýÃû         : main
  41          * º¯Êý¹¦ÄÜ       : Ö÷º¯Êý
  42          * ÊäÈë           : ÎÞ
  43          * Êä³ö           : ÎÞ
  44          *******************************************************************************/
  45          
  46          void main()
  47          {
  48   1        UsartConfiguration();
  49   1        LcdInit();       //³õÊ¼»¯LCD1602
  50   1        LcdWriteCom(0x88);   //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
  51   1        LcdWriteData('C'); 
  52   1        while(1)
  53   1        {
  54   2          LcdDisplay(Ds18b20ReadTemp());
  55   2        }
C51 COMPILER V9.59.0.0   MAIN                                                              12/13/2018 14:59:01 PAGE 2   

  56   1      }
  57          
  58          /*******************************************************************************
  59          * º¯ÊýÃû         : LcdDisplay()
  60          * º¯Êý¹¦ÄÜ       : LCDÏÔÊ¾¶ÁÈ¡µ½µÄÎÂ¶È
  61          * ÊäÈë           : v
  62          * Êä³ö           : ÎÞ
  63          *******************************************************************************/
  64          
  65          void LcdDisplay(int temp)    //lcdÏÔÊ¾
  66          {
  67   1          unsigned char symbol,i, datas[] = {0, 0, 0, 0, 0}; //¶¨ÒåÊý×é
  68   1        float tp;  
  69   1        if(temp< 0)           //µ±ÎÂ¶ÈÖµÎª¸ºÊý
  70   1          {
  71   2            LcdWriteCom(0x80);    //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
  72   2          symbol='-';               //½«½ÓÊÕµ½µÄÊý¾Ý·ÅÈëµ½·¢ËÍ¼Ä´æÆ÷
  73   2          
  74   2            LcdWriteData('-');         //ÏÔÊ¾¸º
  75   2          //ÒòÎª¶ÁÈ¡µÄÎÂ¶ÈÊÇÊµ¼ÊÎÂ¶ÈµÄ²¹Âë£¬ËùÒÔ¼õ1£¬ÔÙÈ¡·´Çó³öÔ­Âë
  76   2          temp=temp-1;
  77   2          temp=~temp;
  78   2          tp=temp;
  79   2          temp=tp*0.0625*100+0.5; 
  80   2          //ÁôÁ½¸öÐ¡Êýµã¾Í*100£¬+0.5ÊÇËÄÉáÎåÈë£¬ÒòÎªCÓïÑÔ¸¡µãÊý×ª»»ÎªÕûÐÍµÄÊ±ºò°ÑÐ¡Êýµã
  81   2          //ºóÃæµÄÊý×Ô¶¯È¥µô£¬²»¹ÜÊÇ·ñ´óÓÚ0.5£¬¶ø+0.5Ö®ºó´óÓÚ0.5µÄ¾ÍÊÇ½ø1ÁË£¬Ð¡ÓÚ0.5µÄ¾Í
  82   2          //ËãÓÉÏ0.5£¬»¹ÊÇÔÚÐ¡ÊýµãºóÃæ¡£
  83   2       
  84   2          }
  85   1        else
  86   1          {     
  87   2            LcdWriteCom(0x80);    //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
  88   2            LcdWriteData('+');    //ÏÔÊ¾Õý
  89   2          symbol='+';//½«½ÓÊÕµ½µÄÊý¾Ý·ÅÈëµ½·¢ËÍ¼Ä´æÆ÷
  90   2        
  91   2          tp=temp;//ÒòÎªÊý¾Ý´¦ÀíÓÐÐ¡ÊýµãËùÒÔ½«ÎÂ¶È¸³¸øÒ»¸ö¸¡µãÐÍ±äÁ¿
  92   2          //Èç¹ûÎÂ¶ÈÊÇÕýµÄÄÇÃ´£¬ÄÇÃ´ÕýÊýµÄÔ­Âë¾ÍÊÇ²¹ÂëËü±¾Éí
  93   2          temp=tp*0.0625*100+0.5; 
  94   2          //ÁôÁ½¸öÐ¡Êýµã¾Í*100£¬+0.5ÊÇËÄÉáÎåÈë£¬ÒòÎªCÓïÑÔ¸¡µãÊý×ª»»ÎªÕûÐÍµÄÊ±ºò°ÑÐ¡Êýµã
  95   2          //ºóÃæµÄÊý×Ô¶¯È¥µô£¬²»¹ÜÊÇ·ñ´óÓÚ0.5£¬¶ø+0.5Ö®ºó´óÓÚ0.5µÄ¾ÍÊÇ½ø1ÁË£¬Ð¡ÓÚ0.5µÄ¾Í
  96   2          //Ëã¼ÓÉÏ0.5£¬»¹ÊÇÔÚÐ¡ÊýµãºóÃæ¡£
  97   2        }
  98   1        datas[0] =  temp / 10000;
  99   1        datas[1] =  temp % 10000 / 1000;
 100   1        datas[2] =  temp % 1000 / 100;
 101   1        datas[3] =  temp % 100 / 10;
 102   1        datas[4] =  temp % 10;
 103   1      
 104   1        LcdWriteCom(0x82);        //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
 105   1        LcdWriteData('0'+datas[0]); //°ÙÎ» 
 106   1        
 107   1        
 108   1        LcdWriteCom(0x83);        //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
 109   1        LcdWriteData('0'+datas[1]); //Ê®Î»
 110   1        
 111   1      
 112   1        LcdWriteCom(0x84);        //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
 113   1        LcdWriteData('0'+datas[2]); //¸öÎ» 
 114   1        
 115   1      
 116   1        LcdWriteCom(0x85);    //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
 117   1        LcdWriteData('.');    //ÏÔÊ¾ ¡®.¡¯
C51 COMPILER V9.59.0.0   MAIN                                                              12/13/2018 14:59:01 PAGE 3   

 118   1        
 119   1      
 120   1        LcdWriteCom(0x86);        //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
 121   1        LcdWriteData('0'+datas[3]); //ÏÔÊ¾Ð¡Êýµã  
 122   1        
 123   1      
 124   1        LcdWriteCom(0x87);        //Ð´µØÖ· 80±íÊ¾³õÊ¼µØÖ·
 125   1        LcdWriteData('0'+datas[4]); //ÏÔÊ¾Ð¡Êýµã 
 126   1      
 127   1        for(i=0;i<5;i++){
 128   2          UART_Send_Byte(datas[i]);
 129   2        }
 130   1        Lcd1602_Delay1ms(2000); 
 131   1      }
 132          /*******************************************************************************
 133          * º¯ Êý Ãû         : UsartConfiguration()
 134          * º¯Êý¹¦ÄÜ       : ÉèÖÃ´®¿Ú
 135          * Êä    Èë         : ÎÞ
 136          * Êä    ³ö         : ÎÞ
 137          *******************************************************************************/
 138          
 139          void UsartConfiguration()
 140          {
 141   1        SCON=0X50;      //ÉèÖÃÎª¹¤×÷·½Ê½1
 142   1        TMOD=0X20;      //ÉèÖÃ¼ÆÊýÆ÷¹¤×÷·½Ê½2
 143   1        PCON=0X80;      //²¨ÌØÂÊ¼Ó±¶
 144   1        TH1=0XFA;       //¼ÆÊýÆ÷³õÊ¼ÖµÉèÖÃ£¬×¢Òâ²¨ÌØÂÊÊÇ4800µÄ
 145   1        TL1=0XFA;
 146   1      //  ES=1;           //´ò¿ª½ÓÊÕÖÐ¶Ï
 147   1      //  EA=1;           //´ò¿ª×ÜÖÐ¶Ï
 148   1        TR1=1;          //´ò¿ª¼ÆÊýÆ÷
 149   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    416    ----
   CONSTANT SIZE    =      5    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      6      12
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
